<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Robert W. Walker">

  
  
  
    
  
  <meta name="description" content="Trump’s Tone A cool post on sentiment analysis can be found here. I will now get at the time series characteristics of his tweets and the sentiment stuff.
I start by loading the tmls object that I created in the previous post.
Trump’s Overall Tweeting What does it look like?
library(tidyverse) library(tidytext) library(SnowballC) library(tm) library(syuzhet) library(rtweet) load(url(&quot;https://github.com/robertwwalker/academic-mymod/raw/master/data/TMLS.RData&quot;)) names(tml.djt) ## [1] &quot;user_id&quot; &quot;status_id&quot; ## [3] &quot;created_at&quot; &quot;screen_name&quot; ## [5] &quot;text&quot; &quot;source&quot; ## [7] &quot;display_text_width&quot; &quot;reply_to_status_id&quot; ## [9] &quot;reply_to_user_id&quot; &quot;reply_to_screen_name&quot; ## [11] &quot;is_quote&quot; &quot;is_retweet&quot; ## [13] &quot;favorite_count&quot; &quot;retweet_count&quot; ## [15] &quot;hashtags&quot; &quot;symbols&quot; ## [17] &quot;urls_url&quot; &quot;urls_t.">

  
  <link rel="alternate" hreflang="en-us" href="/2018/12/19/trump-s-tweets-part-ii/">

  


  
  
  
  <meta name="theme-color" content="#EAF04E">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700%7CJosefin+Slab&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu441e8133bcb5f26868e76fcbf737199b_6526_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu441e8133bcb5f26868e76fcbf737199b_6526_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/2018/12/19/trump-s-tweets-part-ii/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@PieRatio">
  <meta property="twitter:creator" content="@PieRatio">
  
  <meta property="og:site_name" content="rww.science">
  <meta property="og:url" content="/2018/12/19/trump-s-tweets-part-ii/">
  <meta property="og:title" content="Trump&#39;s Tweets, Part II | rww.science">
  <meta property="og:description" content="Trump’s Tone A cool post on sentiment analysis can be found here. I will now get at the time series characteristics of his tweets and the sentiment stuff.
I start by loading the tmls object that I created in the previous post.
Trump’s Overall Tweeting What does it look like?
library(tidyverse) library(tidytext) library(SnowballC) library(tm) library(syuzhet) library(rtweet) load(url(&quot;https://github.com/robertwwalker/academic-mymod/raw/master/data/TMLS.RData&quot;)) names(tml.djt) ## [1] &quot;user_id&quot; &quot;status_id&quot; ## [3] &quot;created_at&quot; &quot;screen_name&quot; ## [5] &quot;text&quot; &quot;source&quot; ## [7] &quot;display_text_width&quot; &quot;reply_to_status_id&quot; ## [9] &quot;reply_to_user_id&quot; &quot;reply_to_screen_name&quot; ## [11] &quot;is_quote&quot; &quot;is_retweet&quot; ## [13] &quot;favorite_count&quot; &quot;retweet_count&quot; ## [15] &quot;hashtags&quot; &quot;symbols&quot; ## [17] &quot;urls_url&quot; &quot;urls_t."><meta property="og:image" content="/img/portrait.jpg">
  <meta property="twitter:image" content="/img/portrait.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2018-12-19T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-01-31T00:02:25-08:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/2018/12/19/trump-s-tweets-part-ii/"
  },
  "headline": "Trump's Tweets, Part II",
  
  "datePublished": "2018-12-19T00:00:00Z",
  "dateModified": "2020-01-31T00:02:25-08:00",
  
  "author": {
    "@type": "Person",
    "name": "Robert W. Walker"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": [{"name":"Atkinson Graduate School of Management","url":"http://agsm.willamette.edu"},{"name":"Willamette University","url":"http:www.willamette.edu/"}],
    "logo": {
      "@type": "ImageObject",
      "url": "img//"
    }
  },
  "description": "Trump’s Tone A cool post on sentiment analysis can be found here. I will now get at the time series characteristics of his tweets and the sentiment stuff.\nI start by loading the tmls object that I created in the previous post.\nTrump’s Overall Tweeting What does it look like?\nlibrary(tidyverse) library(tidytext) library(SnowballC) library(tm) library(syuzhet) library(rtweet) load(url(\u0026quot;https://github.com/robertwwalker/academic-mymod/raw/master/data/TMLS.RData\u0026quot;)) names(tml.djt) ## [1] \u0026quot;user_id\u0026quot; \u0026quot;status_id\u0026quot; ## [3] \u0026quot;created_at\u0026quot; \u0026quot;screen_name\u0026quot; ## [5] \u0026quot;text\u0026quot; \u0026quot;source\u0026quot; ## [7] \u0026quot;display_text_width\u0026quot; \u0026quot;reply_to_status_id\u0026quot; ## [9] \u0026quot;reply_to_user_id\u0026quot; \u0026quot;reply_to_screen_name\u0026quot; ## [11] \u0026quot;is_quote\u0026quot; \u0026quot;is_retweet\u0026quot; ## [13] \u0026quot;favorite_count\u0026quot; \u0026quot;retweet_count\u0026quot; ## [15] \u0026quot;hashtags\u0026quot; \u0026quot;symbols\u0026quot; ## [17] \u0026quot;urls_url\u0026quot; \u0026quot;urls_t."
}
</script>

  

  


  
  
  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.js" integrity="sha256-5VhCqFam2Cn+yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.css" integrity="sha256-zQ0LblD/Af8vOppw18+2anxsuaz3pWYyVWi+bTvTH8Q=" crossorigin="anonymous">
  
  <script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#EAF04E",
          "text": "#dfb8f5"
        },
        "button": {
          "background": "#dfb8f5",
          "text": "#EAF04E"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "/privacy/"
      }
    })});
  </script>



  





  <title>Trump&#39;s Tweets, Part II | rww.science</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="dark">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  






  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu9f3875aeabe8a1aaa7016e57355d11ff_13955_0x75_resize_lanczos_2.png" alt="rww.science"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu9f3875aeabe8a1aaa7016e57355d11ff_13955_0x75_resize_lanczos_2.png" alt="rww.science"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/publication/"><span>Papers</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/project/"><span>Projects</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/r/"><span>R</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/talk/"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/img/vita.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Trump&#39;s Tweets, Part II</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Jan 31, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/r/">R</a>, <a href="/categories/twitter/">twitter</a>, <a href="/categories/tidytext/">tidytext</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<div id="trumps-tone" class="section level1">
<h1>Trump’s Tone</h1>
<p>A cool post on sentiment analysis can be found <a href="http://dataaspirant.com/2018/03/22/twitter-sentiment-analysis-using-r/">here</a>. I will now get at the time series characteristics of his tweets and the sentiment stuff.</p>
<p>I start by loading the tmls object that I created <a href="https://rww.science/post/trump-tweet-word-clouds/">in the previous post</a>.</p>
<div id="trumps-overall-tweeting" class="section level2">
<h2>Trump’s Overall Tweeting</h2>
<p>What does it look like?</p>
<pre class="r"><code>library(tidyverse)
library(tidytext)
library(SnowballC)
library(tm)
library(syuzhet)
library(rtweet)
load(url(&quot;https://github.com/robertwwalker/academic-mymod/raw/master/data/TMLS.RData&quot;))
names(tml.djt)</code></pre>
<pre><code>##  [1] &quot;user_id&quot;                 &quot;status_id&quot;              
##  [3] &quot;created_at&quot;              &quot;screen_name&quot;            
##  [5] &quot;text&quot;                    &quot;source&quot;                 
##  [7] &quot;display_text_width&quot;      &quot;reply_to_status_id&quot;     
##  [9] &quot;reply_to_user_id&quot;        &quot;reply_to_screen_name&quot;   
## [11] &quot;is_quote&quot;                &quot;is_retweet&quot;             
## [13] &quot;favorite_count&quot;          &quot;retweet_count&quot;          
## [15] &quot;hashtags&quot;                &quot;symbols&quot;                
## [17] &quot;urls_url&quot;                &quot;urls_t.co&quot;              
## [19] &quot;urls_expanded_url&quot;       &quot;media_url&quot;              
## [21] &quot;media_t.co&quot;              &quot;media_expanded_url&quot;     
## [23] &quot;media_type&quot;              &quot;ext_media_url&quot;          
## [25] &quot;ext_media_t.co&quot;          &quot;ext_media_expanded_url&quot; 
## [27] &quot;ext_media_type&quot;          &quot;mentions_user_id&quot;       
## [29] &quot;mentions_screen_name&quot;    &quot;lang&quot;                   
## [31] &quot;quoted_status_id&quot;        &quot;quoted_text&quot;            
## [33] &quot;quoted_created_at&quot;       &quot;quoted_source&quot;          
## [35] &quot;quoted_favorite_count&quot;   &quot;quoted_retweet_count&quot;   
## [37] &quot;quoted_user_id&quot;          &quot;quoted_screen_name&quot;     
## [39] &quot;quoted_name&quot;             &quot;quoted_followers_count&quot; 
## [41] &quot;quoted_friends_count&quot;    &quot;quoted_statuses_count&quot;  
## [43] &quot;quoted_location&quot;         &quot;quoted_description&quot;     
## [45] &quot;quoted_verified&quot;         &quot;retweet_status_id&quot;      
## [47] &quot;retweet_text&quot;            &quot;retweet_created_at&quot;     
## [49] &quot;retweet_source&quot;          &quot;retweet_favorite_count&quot; 
## [51] &quot;retweet_retweet_count&quot;   &quot;retweet_user_id&quot;        
## [53] &quot;retweet_screen_name&quot;     &quot;retweet_name&quot;           
## [55] &quot;retweet_followers_count&quot; &quot;retweet_friends_count&quot;  
## [57] &quot;retweet_statuses_count&quot;  &quot;retweet_location&quot;       
## [59] &quot;retweet_description&quot;     &quot;retweet_verified&quot;       
## [61] &quot;place_url&quot;               &quot;place_name&quot;             
## [63] &quot;place_full_name&quot;         &quot;place_type&quot;             
## [65] &quot;country&quot;                 &quot;country_code&quot;           
## [67] &quot;geo_coords&quot;              &quot;coords_coords&quot;          
## [69] &quot;bbox_coords&quot;             &quot;status_url&quot;             
## [71] &quot;name&quot;                    &quot;location&quot;               
## [73] &quot;description&quot;             &quot;url&quot;                    
## [75] &quot;protected&quot;               &quot;followers_count&quot;        
## [77] &quot;friends_count&quot;           &quot;listed_count&quot;           
## [79] &quot;statuses_count&quot;          &quot;favourites_count&quot;       
## [81] &quot;account_created_at&quot;      &quot;verified&quot;               
## [83] &quot;profile_url&quot;             &quot;profile_expanded_url&quot;   
## [85] &quot;account_lang&quot;            &quot;profile_banner_url&quot;     
## [87] &quot;profile_background_url&quot;  &quot;profile_image_url&quot;</code></pre>
<pre class="r"><code>ts_plot(tml.djt, &quot;days&quot;) +
  ggplot2::theme_minimal() +
  ggplot2::theme(plot.title = ggplot2::element_text(face = &quot;bold&quot;)) +
  ggplot2::labs(
    x = NULL, y = NULL,
    title = &quot;Frequency of @realDonaldTrump tweets and retweeets&quot;,
    subtitle = &quot;Twitter status (tweet) counts aggregated using days&quot;,
    caption = &quot;\nSource: Data collected from Twitter&#39;s REST API via rtweet&quot;
  )</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="trumps-tweets-by-day" class="section level2">
<h2>Trump’s Tweets by Day</h2>
<p>I want to first get rid of retweets to render President Trump in his own voice.</p>
<pre class="r"><code>DJTDF &lt;- tml.djt %&gt;% filter(is_retweet==FALSE)
ts_plot(DJTDF, &quot;days&quot;) +
  ggplot2::theme_minimal() +
  ggplot2::theme(plot.title = ggplot2::element_text(face = &quot;bold&quot;)) +
  ggplot2::labs(
    x = NULL, y = NULL,
    title = &quot;Frequency of @realDonaldTrump tweets [retweeets removed]&quot;,
    subtitle = &quot;Twitter status (tweet) counts aggregated using days&quot;,
    caption = &quot;\nSource: Data collected from Twitter&#39;s REST API via rtweet&quot;
  )</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Some more stuff from <a href="https://stackoverflow.com/questions/31348453/how-do-i-clean-twitter-data-in-r">stack overflow</a>. There is quite a bit of code in here. I simply wrote a function that takes an input character string and cleans it up. Uncomment the various components and pipe them. The sequencing is important and I found this to get everything that I wanted.</p>
<pre class="r"><code>library(RColorBrewer)
TDF &lt;- DJTDF %&gt;% select(text)
library(tidyr)
CT &lt;- TDF %&gt;% mutate(tweetno= row_number())
# TDF contains the text of tweets amd the id
library(stringr)
tweet_cleaner &lt;- function(text) {
  temp1 &lt;- str_replace_all(text, &quot;&amp;amp&quot;, &quot;&quot;) %&gt;% 
    str_replace_all(., &quot;https.*&quot;,&quot;&quot;) %&gt;%
#    str_replace_all(., &quot;http.*&quot;, &quot;&quot;) %&gt;%
    str_replace_all(.,&quot;@[a-z,A-Z]*&quot;,&quot;&quot;)
#    str_replace_all(., &quot;[[:punct:]]&quot;, &quot;&quot;)  
#    str_replace_all(., &quot;[[:digit:]]&quot;, &quot;&quot;) %&gt;%
#    str_replace_all(., &quot;[ \t]{2,}&quot;, &quot;&quot;) %&gt;%
#    str_replace_all(., &quot;^\\s+|\\s+$&quot;, &quot;&quot;)  %&gt;%
#    str_replace_all(., &quot; &quot;,&quot; &quot;) %&gt;%
#    str_replace_all(.,&quot;RT @[a-z,A-Z]*: &quot;,&quot;&quot;) %&gt;% 
#    str_replace_all(.,&quot;#[a-z,A-Z]*&quot;,&quot;&quot;)
  return(temp1)
}
clean_tweets &lt;- data.frame(text=sapply(1:dim(TDF)[[1]], function(x) {tweet_cleaner(TDF[x,&quot;text&quot;])}))
clean_tweets$text &lt;- as.character(clean_tweets$text)
clean_tweets$created_at &lt;- DJTDF$created_at
Trumps.Sent.Words &lt;- clean_tweets %&gt;% unnest_tokens(., word, text) %&gt;% anti_join(stop_words, &quot;word&quot;)
# word.df &lt;- as.vector(TDF)
# emotion.df &lt;- get_nrc_sentiment(word.df)
SNTR1 &lt;- apply(TDF, 1, function(x) {get_nrc_sentiment(x)})
Sent.Res &lt;- bind_rows(SNTR1)
head(Sent.Res)</code></pre>
<pre><code>##   anger anticipation disgust fear joy sadness surprise trust negative positive
## 1     1            1       0    2   2       0        1     4        3        4
## 2     0            2       0    0   2       0        1     2        0        3
## 3     0            1       0    1   1       0        0     1        1        2
## 4     1            1       0    1   0       1        1     0        1        3
## 5     4            1       4    3   0       3        1     1        4        0
## 6     3            0       4    2   0       3        1     1        4        1</code></pre>
</div>
</div>
<div id="a-single-number-sentiment" class="section level1">
<h1>A Single Number Sentiment</h1>
<pre class="r"><code>library(tidytext)
SNTRB &lt;- apply(TDF, 1, function(x) {get_sentiment(x, method=&quot;bing&quot;)})
DJTDF$Bing &lt;- SNTRB
DJTDF &lt;- DJTDF %&gt;% mutate(RN=row_number())
DJTDF &lt;- DJTDF
DJTDF &lt;- DJTDF[order(DJTDF$RN, decreasing = T),]
library(tibbletime)</code></pre>
<pre><code>## 
## Attaching package: &#39;tibbletime&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre class="r"><code>DJTDF_tbl_time_d &lt;- DJTDF %&gt;%
     as_tbl_time(index = created_at) 
My.Res &lt;- DJTDF_tbl_time_d %&gt;%
    collapse_by(&quot;daily&quot;) %&gt;%
    dplyr::group_by(created_at) %&gt;%
    dplyr::summarise_if(is.numeric, mean) %&gt;% select(created_at,Bing)
SBP &lt;- My.Res %&gt;% filter(Bing&gt;0)
SBN &lt;- My.Res %&gt;% filter(Bing&lt;0)
plot(My.Res, type=&quot;l&quot;, xlab=&quot;2018&quot;, ylab=&quot;Avg. Bing Sentiment&quot;, main=&quot;Trump&#39;s Bing Daily Mood&quot;)
points(SBP, col=&quot;green&quot;)
points(SBN, col=&quot;red&quot;)
text(My.Res[316,], &quot;GHW Bush Passes&quot;, cex=0.6)
text(My.Res[66,], &quot;March for Our Life&quot;, cex=0.6)</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>table(sign(My.Res$Bing))</code></pre>
<pre><code>## 
##  -1   0   1 
##  84  16 231</code></pre>
<p>That’s pretty interesting. There are considerably more positive days than negative ones. The timing of the maximum and minimum are fairly clear in time. Some changes the tidytext and licenses for sentiments broke this. To fix it, I have to save a local.</p>
<pre class="r"><code>tidy.tweets &lt;- DJTDF %&gt;% select(created_at, text) %&gt;% unnest_tokens(word, text)
afinn &lt;- tidy.tweets %&gt;% 
  inner_join(get_sentiments(&quot;afinn&quot;)) %&gt;% 
  group_by(created_at) %&gt;% 
  summarise(sentiment = sum(value)) %&gt;% 
  mutate(method = &quot;AFINN&quot;)
bing_and_nrc &lt;- bind_rows(tidy.tweets %&gt;% 
                            inner_join(get_sentiments(&quot;bing&quot;)) %&gt;%
                            mutate(method = &quot;Bing&quot;),
                          tidy.tweets %&gt;% 
                            inner_join(get_sentiments(&quot;nrc&quot;) %&gt;% 
                                         filter(sentiment %in% c(&quot;positive&quot;, 
                                                                 &quot;negative&quot;))) %&gt;%
                            mutate(method = &quot;NRC&quot;)) %&gt;%
  count(method, created_at, sentiment) %&gt;%
  spread(sentiment, n, fill = 0) %&gt;%
  mutate(sentiment = positive - negative) %&gt;% select(created_at, sentiment, method)
Sents.Me &lt;- bind_rows(afinn,bing_and_nrc)
SME_tbl_time_d &lt;- Sents.Me  %&gt;% as_tbl_time(index = created_at) 
My.Res &lt;- SME_tbl_time_d %&gt;% group_by(method) %&gt;%
    collapse_by(&quot;daily&quot;) %&gt;%
    dplyr::group_by(created_at, method) %&gt;%
    dplyr::summarise_if(is.numeric, mean) %&gt;% ungroup()
save(Sents.Me,SME_tbl_time_d,My.Res,bing_and_nrc,tidy.tweets, file=&quot;~/TrumpTweets.RData&quot;)</code></pre>
<pre class="r"><code>load(&quot;TrumpTweets.RData&quot;)
ggplot(data = My.Res) +
  aes(x = created_at, y = sentiment, color = method) +
  geom_line() +
  theme_minimal()</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div id="averaging-three-types-of-scaled-sentiments" class="section level2">
<h2>Averaging three types of scaled sentiments</h2>
<pre class="r"><code>MRS &lt;- My.Res %&gt;% group_by(method) %&gt;% mutate(SS=scale(sentiment))
MRS2 &lt;- MRS %&gt;%  collapse_by(&quot;daily&quot;) %&gt;% select(created_at, SS) %&gt;%
    dplyr::group_by(created_at) %&gt;%
    dplyr::summarise_if(is.numeric, mean) </code></pre>
<pre><code>## Adding missing grouping variables: `method`</code></pre>
<pre class="r"><code>ggplot(data = MRS2) +
  aes(x = created_at, y = SS) +
  geom_line(color = &#39;#781c6d&#39;) +
  labs(title = &#39;Sentiment: Averaged&#39;,
    x = &#39;Date&#39;,
    y = &#39;Mean Scaled Sentiment&#39;) +
  theme_minimal()</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="common-words" class="section level2">
<h2>Common Words</h2>
<p>The <code>comparson_cloud()</code> features in <code>wordcloud</code> allow a split of the most common words in the positive and negative sentiment dictionaries.</p>
<pre class="r"><code>library(wordcloud)
library(reshape2)</code></pre>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<pre class="r"><code>tidy.tweets %&gt;%
  inner_join(get_sentiments(&quot;bing&quot;)) %&gt;%
  count(word, sentiment, sort = TRUE) %&gt;%
  acast(word ~ sentiment, value.var = &quot;n&quot;, fill = 0) %&gt;%
  comparison.cloud(colors = c(&quot;red&quot;,&quot;green&quot;),
                   max.words = 100)</code></pre>
<pre><code>## Joining, by = &quot;word&quot;</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="networks" class="section level2">
<h2>Networks</h2>
<pre class="r"><code>library(dplyr)
library(tidyr)
library(tidytext)
library(ggplot2)
library(igraph)</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     as_data_frame, groups, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:purrr&#39;:
## 
##     compose, simplify</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     crossing</code></pre>
<pre><code>## The following object is masked from &#39;package:tibble&#39;:
## 
##     as_data_frame</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre class="r"><code>library(ggraph)

count_bigrams &lt;- function(dataset) {
  dataset %&gt;%
    unnest_tokens(bigram, text, token = &quot;ngrams&quot;, n = 2) %&gt;%
    separate(bigram, c(&quot;word1&quot;, &quot;word2&quot;), sep = &quot; &quot;) %&gt;%
    filter(!word1 %in% stop_words$word,
           !word2 %in% stop_words$word) %&gt;%
    count(word1, word2, sort = TRUE)
}

visualize_bigrams &lt;- function(bigrams) {
  set.seed(2016)
  a &lt;- grid::arrow(type = &quot;closed&quot;, length = unit(.15, &quot;inches&quot;))
  bigrams %&gt;%
    graph_from_data_frame() %&gt;%
    ggraph(layout = &quot;fr&quot;) +
    geom_edge_link(aes(edge_alpha = n), show.legend = FALSE, arrow = a) +
    geom_node_point(color = &quot;lightblue&quot;, size = 5) +
    geom_node_text(aes(label = name), vjust = 1, hjust = 1) +
    theme_void()
}
library(stringr)

djt_bigrams &lt;- clean_tweets %&gt;% select(created_at, text) %&gt;% 
  count_bigrams()

# filter out rare combinations, as well as digits
djt_bigrams %&gt;%
  filter(n &gt; 20,
         !str_detect(word1, &quot;\\d&quot;),
         !str_detect(word2, &quot;\\d&quot;)) %&gt;%
  visualize_bigrams()</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>clean_tweets$RN &lt;- DJTDF$RN
tidy.tweets.RN &lt;- clean_tweets %&gt;% select(RN, text) %&gt;% unnest_tokens(word, text) %&gt;%
  anti_join(stop_words) %&gt;%
  count(RN, word, sort = TRUE) %&gt;%
  ungroup()</code></pre>
<pre><code>## Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>tweets_dtm &lt;- tidy.tweets.RN %&gt;%
  cast_dtm(RN, word, n)
library(topicmodels)
tweets_lda &lt;- LDA(tweets_dtm, k = 7, control = list(seed = 12345))
tweet_topics &lt;- tidy(tweets_lda, matrix=&quot;beta&quot;)
top_terms &lt;- tweet_topics %&gt;% group_by(topic) %&gt;% top_n(10, beta) %&gt;%
    ungroup() %&gt;%
    arrange(topic, -beta)
top_terms %&gt;%
    mutate(term = reorder(term, beta)) %&gt;%
    ggplot(aes(term, beta, fill = factor(topic))) +
    geom_col(show.legend = FALSE) +
    facet_wrap(~ topic, scales = &quot;free&quot;) +
    coord_flip()</code></pre>
<p><img src="/post/2018-12-19-trump-s-tweets-part-ii/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>tweet_topicM &lt;- tidy(tweets_lda, matrix=&quot;gamma&quot;)
top_tweets &lt;- tweet_topicM %&gt;% group_by(topic) %&gt;% top_n(10, gamma) %&gt;%
    ungroup() %&gt;%
    arrange(topic, -gamma)
top_tweets</code></pre>
<pre><code>## # A tibble: 70 x 3
##    document topic gamma
##    &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;
##  1 1888         1 0.172
##  2 555          1 0.171
##  3 252          1 0.170
##  4 234          1 0.167
##  5 1830         1 0.166
##  6 1340         1 0.166
##  7 2525         1 0.166
##  8 434          1 0.163
##  9 1101         1 0.162
## 10 399          1 0.162
## # … with 60 more rows</code></pre>
<pre class="r"><code>Tweet.Res &lt;- cbind(TDF[as.numeric(top_tweets$document),],top_tweets)</code></pre>
<p>Mallet is finicky. Below is some playing with it but the stop words are messy.</p>
<pre class="r"><code>library(qdap)
clean_tweets$text &lt;- clean_tweets %&gt;% select(text) %&gt;% rm_stopwords(., tm::stopwords(&quot;english&quot;), separate = FALSE, unlist=FALSE)
library(mallet)
clean_tweets$RN &lt;- as.character(clean_tweets$RN)
clean_tweets &lt;- clean_tweets
# create an empty file of &quot;stopwords&quot;
# file.create(empty_file &lt;- tempfile())
# mystopwords &lt;- as.character(stop_words[,1])
stopwords_en &lt;-  stop_words
#system.file(&quot;stoplists/en.txt&quot;, package = &quot;mallet&quot;)
docs &lt;- mallet.import(clean_tweets$RN, clean_tweets$text, stoplist=stopwords_en)
mallet_model &lt;- MalletLDA(num.topics = 6)
mallet_model$loadDocuments(docs)
mallet_model$train(250)
mallet_model$maximize(100)
topic.words &lt;- mallet.topic.words(mallet_model, smoothed=TRUE, normalized=TRUE)
names(topic.words)
mallet.top.words(mallet_model, word.weights = topic.words[4,], num.top.words = 5)</code></pre>
</div>
<div id="sentiments-and-tidy-calendars" class="section level2">
<h2>Sentiments and Tidy Calendars</h2>
<p>Now I want to play with the time series properties of the tweet sentiments. Days of the week and times of day aggregated over different periods can say something… Perhaps some day?</p>
</div>
</div>

    </div>

    



<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/r/">R</a>
  
  <a class="badge badge-light" href="/tags/r-markdown/">R Markdown</a>
  
  <a class="badge badge-light" href="/tags/tidytext/">tidytext</a>
  
  <a class="badge badge-light" href="/tags/twitter-sentiment/">twitter sentiment</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/2018/12/19/trump-s-tweets-part-ii/&amp;text=Trump&amp;#39;s%20Tweets,%20Part%20II" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/2018/12/19/trump-s-tweets-part-ii/&amp;t=Trump&amp;#39;s%20Tweets,%20Part%20II" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Trump&amp;#39;s%20Tweets,%20Part%20II&amp;body=/2018/12/19/trump-s-tweets-part-ii/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/2018/12/19/trump-s-tweets-part-ii/&amp;title=Trump&amp;#39;s%20Tweets,%20Part%20II" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Trump&amp;#39;s%20Tweets,%20Part%20II%20/2018/12/19/trump-s-tweets-part-ii/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/2018/12/19/trump-s-tweets-part-ii/&amp;title=Trump&amp;#39;s%20Tweets,%20Part%20II" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu5dc180fe8d34aaa1cfa26dba9dfe8fe0_107194_270x270_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Robert W. Walker</a></h5>
      <h6 class="card-subtitle">Associate Professor of Quantitative Methods</h6>
      <p class="card-text">My research interests include causal inference, statistical computation and data visualisation.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/PieRatio" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=FU8pL7sAAAAJ&amp;hl" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/robertwwalker" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/img/vita.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>







<div class="article-widget">
  
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/2019/03/17/stocks-and-gganimate/" rel="next">Stocks and gganimate</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/2018/12/18/trump-tweet-word-clouds/" rel="prev">Trump Tweet Word Clouds</a>
  </div>
  
</div>

</div>



  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/2018/04/08/scraping-epl-salary-data/">Scraping EPL Salary Data</a></li>
      
      <li><a href="/2018/02/21/tidytext-is-neat/">tidytext is neat! White House Communications</a></li>
      
      <li><a href="/2018/12/18/trump-tweet-word-clouds/">Trump Tweet Word Clouds</a></li>
      
      <li><a href="/2018/02/22/black-boxes-a-gender-gap-example/">Black Boxes: A Gender Gap Example</a></li>
      
      <li><a href="/2018/02/22/correlation-function/">Correlation Function</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js" integrity="sha256-JEqEejGt4tR35L0a1zodzsV0/PJ6GIf7J4yDtywdrH8=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.0630fec5958cb075a5a38f042b3ddde6.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    © 2018 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
